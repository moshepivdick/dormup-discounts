# Инструкция по применению миграций

## Проблема
В логах видны ошибки:
- `The column Venue.priceLevel does not exist` 
- `The table public.venue_views does not exist`

Это нормально - код обрабатывает эти ошибки gracefully, но для полной функциональности нужно применить миграции.

## Решение: Применить 2 миграции в Supabase

### Шаг 1: Откройте Supabase Dashboard
1. Зайдите в ваш проект на [supabase.com](https://supabase.com)
2. Перейдите в **SQL Editor** (в левом меню)

### Шаг 2: Примените миграцию для таблицы venue_views
1. Откройте файл `APPLY_VENUE_VIEWS_TABLE.sql`
2. Скопируйте весь его содержимое
3. Вставьте в SQL Editor в Supabase
4. Нажмите **Run** (или `Ctrl+Enter`)
5. Должно появиться сообщение "Success. No rows returned"

### Шаг 3: Примените миграцию для price level полей
1. Откройте файл `APPLY_PRICE_LEVEL_MIGRATION.sql`
2. Скопируйте весь его содержимое
3. Вставьте в SQL Editor в Supabase
4. Нажмите **Run** (или `Ctrl+Enter`)
5. Должно появиться сообщение "Success. No rows returned"

### Шаг 4: (Опционально) Обновите Prisma Client
После применения миграций, если вы работаете локально:
```bash
npx prisma generate
```

### Шаг 5: Проверка
После применения миграций:
- ✅ Ошибки `priceLevel does not exist` исчезнут
- ✅ Ошибки `venue_views does not exist` исчезнут
- ✅ Трекинг просмотров заведений начнет работать
- ✅ Ценовые индикаторы (€, €€, €€€) будут доступны в админ-панели

## Важно
- Миграции безопасны: используют `IF NOT EXISTS` и `ADD COLUMN IF NOT EXISTS`
- Можно запускать несколько раз без вреда
- Существующие данные не будут затронуты
- Новые колонки будут `NULL` до тех пор, пока вы не заполните их через админ-панель

## Если что-то пошло не так
Если миграция не применилась:
1. Проверьте, что вы используете правильную базу данных в Supabase
2. Убедитесь, что таблица `Venue` существует
3. Проверьте логи ошибок в SQL Editor
4. Свяжитесь с разработчиком с копией ошибки
